
<!DOCTYPE html>
<html lang="fr">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>React – useEffect & useState</title>

  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-slate-900 text-white min-h-screen flex flex-col items-center justify-center p-4">
  <h1 class="text-3xl font-bold mb-6">Suivi de température</h1>
  <div id="root" class="w-full max-w-xl"></div>

  <script type="text/babel">
    const { useState, useEffect } = React;

    /**
     * COMPOSANT COUNTER - Démonstration du cycle de vie React
     * - Gère un compteur avec useState
     * - Utilise useEffect pour observer le cycle de vie
     */
    function Counter() {
      // ÉTAT LOCAL : count commence à 0, se met à jour à chaque clic
      // Chaque changement déclenche un re-render du composant
      const [count, setCount] = useState(0);

      // useEffect SANS tableau de dépendances = se déclenche à CHAQUE rendu
      // Cela inclut : MONTAGE initial + chaque MISE À JOUR
      useEffect(() => {

        //. À chaque MISE À JOUR (count = 1, 2, 3, etc.)
        console.log("MONTAGE / MISE À JOUR :", count);

        // FONCTION DE NETTOYAGE (cleanup) - CRUCIALE pour éviter les fuites mémoire
        // Elle s'exécute :
        // 1. AVANT chaque nouveau rendu (pour nettoyer l'effet précédent)
        // 2. Au DÉMONTAGE du composant (quand il disparaît du DOM)
        return () => {
          console.log("NETTOYAGE :", count);
        };
      }); // Pas de tableau de dépendances = effet à chaque rendu

      return (
        <React.Fragment>
          <p>Compteur : {count}</p>
          {/* Chaque clic déclenche setCount → re-render → useEffect */}
          <button
            onClick={() => setCount(count + 1)}
            className="bg-blue-600 hover:bg-blue-700 px-4 py-2 rounded mt-2"
          >
            +1
          </button>
        </React.Fragment>
      );
    }

    /**
     * COMPOSANT APP - Contrôle le montage/démontage de Counter
     * - status = true : Counter est monté (visible)
     * - status = false : Counter est démonté (invisible)
     */
    function App() {
      const [status, setStatus] = useState(true);
useEffect(() => {
        console.log(status);
        
        return () => {
         //console.log(status);
        };
      });
      return (
        <div className="bg-slate-800 p-4 rounded-xl shadow-lg">
          {/* BOUTON DE CONTRÔLE DU CYCLE DE VIE */}
          {/* Changer status déclenche MONTAGE ou DÉMONTAGE de Counter */}
          <button
            onClick={() => setStatus(!status)}
            className="bg-gray-600 hover:bg-gray-700 px-4 py-2 rounded mb-4"
          >
            Changer le statut
          </button>
          {status && <Counter />}
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById("root")).render(<App />);
  </script>
</body>
</html>